<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel - Arka Living</title>
  
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> 
  
  </head>
<body>
  <script>
    // 1. Definisikan path config.yml
    window.CMS_CONFIGURATION = {
      config: '/admin/config.yml'
    };

    // 2. Muat Decap CMS secara ASINKRON setelah Identity siap
    function loadCMS() {
      const script = document.createElement('script');
      script.src = 'https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js';
      document.body.appendChild(script);
      console.log("Decap CMS loaded!"); // Untuk debugging
    }

    // 3. TUNGGU Identity Widget siap diinisialisasi
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('init', user => {
        // Jika Identity siap (terlepas dari user login/tidak), muat CMS
        loadCMS(); 
      });

      // Tambahan: Identity.init() harus dipanggil jika tidak dipanggil otomatis
      window.netlifyIdentity.init();
    } else {
      // Fallback jika Netlify Identity gagal dimuat
      loadCMS();
    }
  </script>
</body>
</html>